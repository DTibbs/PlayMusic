;## Information ################################################################
; Filename: PlayMusic(Square).ini
; Project: PlayMusic
; Author: Brett Stevenson
; Contact: BStevensonDev@gmail.com
; Version: v1.2.1
; License: GNU AGPLv3.0
; Updated: Mar 10, 2017
; Copyright (c) 2016 Brett Stevenson
;
; Have any advice for how to make this skin better?
; Let me know: https://github.com/JonSn0w/PlayMusic/issues/new
;###############################################################################

[Metadata]
Name=PlayMusic(Square)
Author=Brett Stevenson
Version=v1.2.1
License=GNU AGPLv3

[Rainmeter]
MiddleMouseUpAction=!Refresh #CURRENTCONFIG#
OnUpdateAction=[!WriteKeyValue Variables variant "Square" "#@#Variables.inc"][!UpdateMeasure VisualizerScript]
ContextTitle="Config"
ContextAction=[!ToggleConfig "PlayMusic\Config" "Settings.ini"][!Redraw]
ContextTitle2="Open GPMDP"
ContextAction2=[#AppPath#]
MouseActionCursor=0
Update=30

;------------------------------------------------------------------------------
; VARIABLES

[Variables]
@include=#@#Styles.inc
@include2=#@#Variables.inc
@include3=#@#Chameleon.inc
@include4=#@#Measures.inc
scale=1
visualizerWidth=(#size#*31.1)
bandSpace=(#size#-4.5)+2
bandCount=((#visualizerWidth#+(#bandSpace#*3))/(#barWidth#+#bandSpace#))+1
BarHeightScale=(20*#size#*#scale#)
BarWidthScale=(#barWidth#)*#scale#
alignmentment=1
foregroundColor=E22D30
backgroundColor=EDEDED


;------------------------------------------------------------------------------
; MEASURES

[VisualizerScript]
Measure=Script
ScriptFile=#@#Scripts\Visualizer.lua
IncFile=#@#Include\BandMeters.inc
EnableVisualizer=#showVisualizer#
BarCount=#bandCount#
Spacing=#bandSpace#
UpdateDivider=5

[MeasureRepeat]
Measure=Plugin
Plugin=WebParser
URL=[MeasureJSON]
StringIndex=3
IfMatch=NO_REPEAT
IfMatchAction=[!SetOption MeterRepeat ImageAlpha 75][UpdateMeter MeterRepeat][!Redraw]
IfNotMatchAction=[!SetOption MeterRepeat ImageAlpha 250][UpdateMeter MeterRepeat][!Redraw]
DynamicVariables=1
UpdateDivider=25

[MeasureShuffle]
Measure=Plugin
Plugin=WebParser
URL=[MeasureJSON]
StringIndex=2
IfMatch=NO_SHUFFLE
IfMatchAction=[!SetOption MeterShuffle ImageAlpha 75][UpdateMeter MeterShuffle][!Redraw]
IfNotMatchAction=[!SetOption MeterShuffle ImageAlpha 250][UpdateMeter MeterShuffle][!Redraw]
DynamicVariables=1
UpdateDivider=25

[MeasureShowVisualizer]
Measure=Calc
Formula=#showVisualizer#
IfEqualValue=0
IfEqualAction=[!HideMeterGroup Visualizer][!UpdateMeter *][!Redraw]
IfAboveValue=0
IfAboveAction=[!ShowMeterGroup Visualizer][!UpdateMeasure VisualizerScript][!UpdateMeter *][!Redraw]
DynamicVariables=1
UpdateDivider=10

[MeasureAlignmentment]
Measure=Calc
Formula=#WORKAREAWIDTH#/2
IfAboveValue=#CURRENTCONFIGX#
IfAboveAction=[!WriteKeyValue Variables alignmentment "1"][!WriteKeyValue Variables alignmentValue "0" "#@#Variables.inc"][!UpdateMeter *][!Redraw]
IfBelowValue=#CURRENTCONFIGX#
IfBelowAction=[!WriteKeyValue Variables alignmentment "18"][!WriteKeyValue Variables alignmentValue "1" "#@#Variables.inc"][!UpdateMeter *][!Redraw]

; [HideActive]
; Measure=Calc
; Formula=1
; IfCondition=(#GPMDPOpen# = 0)
; IfTrueAction=[!HideMeterGroup Active][!ShowMeterGroup Icon][!UpdateMeter *][!Redraw]
; IfFalseAction=[!ShowMeterGroup Active][!HideMeterGroup Icon][!UpdateMeter *][!Redraw]
; DynamicVariables=1
; UpdateDivider=10

[MeasureVolumeControl]
Measure=Calc
Formula=#EnableVolumeControl#
IfEqualValue=0
IfEqualAction=[!DisableMeasure MeasureVolume][!UpdateMeter *][!Redraw]
IfAboveValue=0
IfAboveAction=[!EnableMeasure MeasureVolume][!UpdateMeter *][!Redraw]
DynamicVariables=1

; @Include Visualizer Band Measures
@include5=#@#Include\BandMeasures.inc


;------------------------------------------------------------------------------
; METERS


[Background]
Meter=Shape
Group=Active
Shape=Rectangle 1, 1, (#size#*32.3), (#size#*32.4), 0 | Fill Color 0,0,0,100 | Stroke 1 | Stroke Color 0,0,0,100
UpdateDivider=20

[MeterArtwork]
Meter=Image
Group=Active
MeasureName=MeasureArtwork
ImageAlpha=225
X=#size#
Y=(#size#*0.8)
H=(#size#*31.1)
W=(#size#*31.1)
MouseOverAction=[!ShowMeterGroup Info][!Redraw]
MouseLeaveAction=[!HideMeterGroup Info][!HideMeterGroup Volume][!Redraw]
DynamicVariables=1
UpdateDivider=10

[MeterBand]
Meter=Bar
Group=Active | Visualizer
MeasureName=MeasureBand0
X=(#size#*0.4)+((#size#-4.5)*5.8)
Y=(#size#*11.7)+((#size#-4.5)*1.8)
DynamicVariables=1
AntiAlias=1

; @Include Visualizer Band Meters
@include6=#@#Include\BandMeters.inc

[Filter]
Meter=Shape
Group=Active | Info
; Shape=Rectangle (#size#*31.4), (#size#*0.7), (#size#*31.4), (#size#*31.1), 0 | Fill Color 0,0,0,100 | Stroke 1 | Stroke Color 0,0,0,0
Shape=Rectangle (#size#-1), (#size#-1.5), (#size#*31.1), (#size#*31.1), 0 | Fill Color 0,0,0,100 | Stroke 1 | Stroke Color 0,0,0,0
UpdateDivider=10

[MeterVolumeBox]
Meter=Shape
Group=Active
; Shape=Rectangle (#size#*31.2), (#size#*0.2), (#size#*32), (#size#*32.4), 0 | Fill Color 0,0,0,0 | Stroke 1 | Stroke Color 0,0,0,0
Shape=Rectangle (#size#*(0.5+#alignment#)), (#size#*0.2), (#size#*32), (#size#*32.4), 0 | Fill Color 0,0,0,0 | Stroke 1 | Stroke Color 0,0,0,0
MouseScrollDownAction=[!ShowMeterGroup Volume][!CommandMeasure MeasureVolume "ChangeVolume -#VolumeStep#"][!Update][!Redraw]
MouseScrollUpAction=[!ShowMeterGroup Volume][!CommandMeasure MeasureVolume "ChangeVolume +#VolumeStep#"][!Update][!Redraw]
MouseLeaveAction=[!HideMeterGroup Volume][!Redraw]

[MeterTitle]
Meter=String
Group=Active | Info
MeterStyle=SquareText
Text=#SongTitle#
Y=(#size#*16.8)
UpdateDivider=10

[MeterArtist]
Meter=String
Group=Active | Info
MeterStyle=SquareText
FontSize=(#size#*2.5)
Text=#SongArtist#
X=r
Y=(#size#*4.9)r
UpdateDivider=10

[MeterAlbum]
Meter=String
Group=Active | Info
MeterStyle=SquareText
FontSize=(#size#*2)
StringStyle=Italic
Text=#SongAlbum#
X=1r
Y=(#size#*5.3)r
UpdateDivider=10

[MeterRepeat]
Meter=Image
Group=Active
MeterStyle=Status
ImageName=#@#Images\repeat.png
ImageAlpha=125
X=(#size#*26.6)
Y=(#size#*1.8)
H=(#size#*4.7)
UpdateDivider=15

[MeterShuffle]
Meter=Image
Group=Active
MeterStyle=Status
ImageName=#@#Images\shuffle.png
ImageAlpha=125
X=(#size#*26.5)
Y=(#size#*7.6)
H=(#size#*4.7)
UpdateDivider=15

[MeterTime]
Meter=Bar
Group=Active
MeterStyle=TimeStyle
MeasureName=MeasureTime
SolidColor=255,225,255,50
BarColor=[ColorForeground2]
; X=(#size#*31.4)
X=(#size#*0.9)
Y=(#size#*31.9)
H=(#size#*0.7)
W=(#size#*30.9)

[MeterInfo]
Meter=Image
Group=Active
ImageName=#@#Images\dots.png
ImageTint=245,245,245
ImageAlpha=135
PreserveAspectRatio=1
; X=(#size#*31.7)
X=#size#
Y=(#size#*1.3)
W=(#size#*2.9)
MouseOverAction=[!SetOption MeterInfo ImageAlpha 245][!Redraw]
MouseLeaveAction=[!SetOption MeterInfo ImageAlpha 135][!Redraw]
LeftMouseDownAction=[!SetOption MeterInfo ImageAlpha 245][!Redraw]
LeftMouseUpAction=[!ToggleConfig "PlayMusic\Config" "Settings.ini"][!SetOption MeterInfo ImageAlpha 135][!Redraw]
MouseActionCursor=1
UpdateDivider=15

[MeterVolume]
Meter=Bar
MeasureName=MeasureVolume
Group=Active | Volume
BarOrientation=Vertical
; X=(#size#*30.9)
X=#size#
Y=(#size#*0.8)
H=(#size#*31.1)
W=(#size#*30.9)
SolidColor=0,0,0,0
BarColor=FFFFFF5E
DynamicVariables=1
AntiAlias=1
Hidden=1

; [VolumeValue]
; Meter=String
; MeasureName=MeasureVolumeValue
; Group=Active | Volume
; FontSize=8
; FontColor=255,255,255,180
; StringEffect=Shadow
; FontEffectColor=90,90,90,150
; ; X=(#size#*32)
; X=(#size#*(1.3+#alignment#))
; Y=(#size#*7.4)
; AntiAlias=1

[MeterPlaybackPrompt]
Meter=String
MeterStyle=SquareTextStyle
FontSize=(#size#*2.9)
FontColor=250,250,250,200
Stringalignment=Center
Text=Enable 'Playback API' in GPMDP's Desktop Settings
; X=(#size#*47)
X=(#size#*(16.3+#alignment#))
Y=(#size#*8.5)
W=(#size#*38)-((5-#size#)*30)
H=150
LeftMouseUpAction=[#AppPath#]
ClipString=2
MouseActionCursor=1
DynamicVariables=1
UpdateDivider=20
Hidden=1

[MeterIcon]
Meter=Image
Group=Icon
ImageName=#icon#
ImageTint=#accent#
ImageAlpha=200
; X=234
X=8+(#alignmentment#*7.4)
Y=3
H=51
LeftMouseUpAction=[#AppPath#]
PreserveAspectRatio=1
MouseActionCursor=1
DynamicVariables=1
UpdateDivider=20

; [Test]
; Meter=String
; Group=Info
; FontColor=255,255,255
; X=50
; Y=50
; Text=#CURRENTCONFIGX# - #alignmentment#
; DynamicVariables=1
