;## Information ################################################################
; Filename: PlayMusic(Round).ini
; Project: PlayMusic
; Author: Brett Stevenson
; Contact: BStevensonDev@gmail.com
; Version: v1.0.6
; License: GNU AGPLv3.0
; Updated: Jan 19, 2017
; Copyright (c) 2016 Brett Stevenson
;###############################################################################

[Rainmeter]
Name=PlayMusic
Author=Brett Stevenson
Contact=BStevensonDev@gmail.com
Version=v1.0.6
Update=20
OnUpdateAction=[!WriteKeyValue Variables variant "Round" "#@#Variables.inc"]
MouseOverAction=[!ShowMeterGroup Info][!UpdateMeter *][!Redraw]
MouseLeaveAction=[!HideMeterGroup Info][!UpdateMeter *][!Redraw]
; MouseActionCursor=0
MouseActionCursorName=customCursor.cur

;------------------------------------------------------------------------------
; VARIABLES

[Variables]
@include=#@#Styles.inc
@include2=#@#Variables.inc
scale=1
barWidth=#size#
bandCount=26
averageSize=3
BarHeightScale=(100*#scale#)
BarWidthScale=(#barWidth#)*#scale#
EnableDynamicColors=0

;------------------------------------------------------------------------------
; MEASURES

[MeasureLuaScript]
Measure=Script
ScriptFile=#@#GPMDP.lua
Playback=#PlaybackPath#
Settings=#SettingsPath#
WriteFile=#@#settings.txt
JSONParser=#@#JSON.lua

[MeasureImageDownload]
Measure=Plugin
Plugin=WebParser
URL=#AlbumArtUrl#
Download=1
DynamicVariables=1
DownloadFile=image.jpg
UpdateDivider=3

[MeasureJSON]
Measure=Plugin
Plugin=WebParser.dll
URL=file://#PlaybackPath#
RegExp=(?siU)"song.*songLyrics": (.*)"shuffle": "(.*)".*repeat": "(.*)"

[ShuffleStatus]
Measure=Plugin
Plugin=WebParser
URL=[MeasureJSON]
StringIndex=2
DynamicVariables=1
UpdateDivider=5

[MeasureShuffle]
Measure=String
String=[ShuffleStatus]
IfMatch=NO_SHUFFLE
IfMatchAction=[!SetOption MeterShuffle ImageAlpha 75][!Redraw]
IfNotMatchAction=[!SetOption MeterShuffle ImageAlpha 245][!Redraw]
DynamicVariables=1
UpdateDivider=5

[RepeatStatus]
Measure=Plugin
Plugin=WebParser
URL=[MeasureJSON]
StringIndex=3
DynamicVariables=1
UpdateDivider=5

[MeasureRepeat]
Measure=String
String=[RepeatStatus]
IfMatch=NO_REPEAT
IfMatchAction=[!SetOption MeterRepeat ImageAlpha 75][!Redraw]
IfNotMatchAction=[!SetOption MeterRepeat ImageAlpha 245][!Redraw]
DynamicVariables=1
UpdateDivider=5

[MeasureTime]
Measure=Calc
Formula=#Length#
DynamicVariables=1

[MeasureVisualizer]
Measure=Calc
Formula=#showVisualizer#
IfEqualValue=0
IfEqualAction=[!HideMeterGroup Visualizer][!UpdateMeter *][!Redraw]
IfAboveValue=0
IfAboveAction=[!ShowMeterGroup Visualizer][!UpdateMeter *][!Redraw]
DynamicVariables=1
UpdateDivider=2

[MinimizeSetting]
Measure=Calc
Formula=#MinimizeStatus#
IfEqualValue=0
IfEqualAction=[!DisableMeasure HideActive][!HideMeterGroup Icon][!UpdateMeter *][!Redraw]
IfAboveValue=0
IfAboveAction=[!EnableMeasure HideActive][!ShowMeterGroup Icon][!UpdateMeter *][!Redraw]
DynamicVariables=1

[HideActive]
Measure=Calc
Formula=1
IfCondition=(#GPMDPOpen# = 0)
IfTrueAction=[!HideMeterGroup Active][!ShowMeterGroup Icon][!UpdateMeter *][!Redraw]
IfFalseAction=[!ShowMeterGroup Active][!HideMeterGroup Icon][!UpdateMeter *][!Redraw]
DynamicVariables=1
UpdateDivider=2

[MeasureVolumeControl]
Measure=Calc
Formula=#EnabledVolumeControl#

[MeasureVolume]
Measure=Plugin
Plugin=Win7AudioPlugin

[MeasureVolumeValue]
Measure=CALC
Formula=MeasureVolume
Substitute="-1":"Muted"

[MeasureAudio]
Measure=Plugin
Plugin=AudioLevel
Port=Output
FFTSize=2048
FFTAttack=25
FFTDecay=50
RMSAttack=10
RMSDecay=1000
RMSGain=20
Bands=#bandCount#
Sensitivity=([MeasureAverageVolume]*([MeasureAverageVolume]*38))
FreqMin=30
FreqMax=12000
DynamicVariables=1

[MeasureAudioAverage]
Measure=Plugin
Plugin=AudioLevel
Port=Output
RMSAttack=10
RMSDecay=2500
RMSGain=1000
Sensitivity=100
FreqMin=30
FreqMax=12000
DynamicVariables=1

[MeasureAverageVolume]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudioAverage
Channel=Avg
Type=RMS

[MeasureBand0]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=0
[MeasureBand1]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=1
AverageSize=#AverageSize#
[MeasureBand2]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=2
AverageSize=#AverageSize#
[MeasureBand3]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=3
AverageSize=#AverageSize#
[MeasureBand4]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=4
AverageSize=#AverageSize#
[MeasureBand5]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=5
AverageSize=#AverageSize#
[MeasureBand6]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=6
AverageSize=#AverageSize#
[MeasureBand7]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=7
AverageSize=#AverageSize#
[MeasureBand8]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=8
AverageSize=#AverageSize#
[MeasureBand9]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=9
AverageSize=#AverageSize#
[MeasureBand10]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=10
AverageSize=#AverageSize#
[MeasureBand11]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=11
AverageSize=#AverageSize#
[MeasureBand12]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=12
AverageSize=#AverageSize#
[MeasureBand13]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=13
AverageSize=#AverageSize#
[MeasureBand14]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=14
AverageSize=#AverageSize#
[MeasureBand15]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=15
AverageSize=#AverageSize#
[MeasureBand16]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=16
AverageSize=#AverageSize#
[MeasureBand17]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=17
AverageSize=#AverageSize#
[MeasureBand18]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=18
AverageSize=#AverageSize#
[MeasureBand19]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=19
AverageSize=#AverageSize#
[MeasureBand20]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=20
AverageSize=#AverageSize#
[MeasureBand21]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=21
AverageSize=#AverageSize#
[MeasureBand22]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=22
AverageSize=#AverageSize#
[MeasureBand23]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=23
AverageSize=#AverageSize#
[MeasureBand24]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=24
AverageSize=#AverageSize#
[MeasureBand25]
Measure=Plugin
Plugin=AudioLevel
Parent=MeasureAudio
Type=Band
BandIdx=25
AverageSize=#AverageSize#

;------------------------------------------------------------------------------
; METERS


[Background]
Meter=Shape
Group=Active
Shape=Ellipse (#size#*18),(#size#*18),(#size#*21),(#size#*21),(#size#*3) | Fill Color 0,0,0,180 | StrokeWidth 1 | Stroke Color 0,0,0,125
X=(#size#*6)
Y=(#size#*5)
MouseScrollDownAction=[!ShowMeterGroup Volume][!CommandMeasure MeasureVolume "ChangeVolume -#VolumeStep#"][!Update][!Redraw]
MouseScrollUpAction=[!ShowMeterGroup Volume][!CommandMeasure MeasureVolume "ChangeVolume +#VolumeStep#"][!Update][!Redraw]
MouseLeaveAction=[!HideMeterGroup Volume][!Redraw]

[MeterArtwork]
Meter=Image
Group=Active
MeasureName=MeasureImageDownload
MaskImageName=#@#images\mask.png
ImageAlpha=235
X=(#size#*3)
Y=(#size#*1.8)
H=(#size#*42)
W=(#size#*42)
MouseOverAction=[!ShowMeterGroup Info][!ShowMeter Filter][!Redraw]
MouseLeaveAction=[!HideMeterGroup Info][!HideMeter Filter][!Redraw]
DynamicVariables=1

;-------------------------- Visualizer -------------------------------

[MeterBand0]
Meter=Bar
Group=Active | Visualizer
MeasureName=MeasureBand0
X=(#size#*3.8)+((5-#size#)*7)
Y=(#size#*25.8)-((5-#size#)*18)
DynamicVariables=1
AntiAlias=1
[MeterBand1]
Meter=Bar
MeasureName=MeasureBand1
MeterStyle=VisualizerStyle
; SolidColor=255,255,255,255
Y=(#size#*14.3)+((5-#size#)*7)
[MeterBand2]
Meter=Bar
MeasureName=MeasureBand2
MeterStyle=VisualizerStyle
; SolidColor=255,255,255,255
Y=(#size#*17.2)-((5-#size#)*18)
[MeterBand3]
Meter=Bar
MeasureName=MeasureBand3
MeterStyle=VisualizerStyle
Y=(#size#*18.9)-((5-#size#)*18)
[MeterBand4]
Meter=Bar
MeasureName=MeasureBand4
MeterStyle=VisualizerStyle
Y=(#size#*20.5)-((5-#size#)*18)
[MeterBand5]
Meter=Bar
MeasureName=MeasureBand5
MeterStyle=VisualizerStyle
Y=(#size#*21.6)-((5-#size#)*18)
[MeterBand6]
Meter=Bar
MeasureName=MeasureBand6
MeterStyle=VisualizerStyle
Y=(#size#*22.8)-((5-#size#)*18)
[MeterBand7]
Meter=Bar
MeasureName=MeasureBand7
MeterStyle=VisualizerStyle
Y=(#size#*23.6)-((5-#size#)*18)
[MeterBand8]
Meter=Bar
MeasureName=MeasureBand8
MeterStyle=VisualizerStyle
Y=(#size#*24.4)-((5-#size#)*18)
[MeterBand9]
Meter=Bar
MeasureName=MeasureBand9
MeterStyle=VisualizerStyle
Y=(#size#*25)-((5-#size#)*18)
[MeterBand10]
Meter=Bar
MeasureName=MeasureBand10
MeterStyle=VisualizerStyle
Y=(#size#*25.4)-((5-#size#)*18)
[MeterBand11]
Meter=Bar
MeasureName=MeasureBand11
MeterStyle=VisualizerStyle
Y=(#size#*25.7)-((5-#size#)*18)
[MeterBand12]
Meter=Bar
MeasureName=MeasureBand12
MeterStyle=VisualizerStyle
Y=(#size#*25.9)-((5-#size#)*18)
[MeterBand13]
Meter=Bar
MeasureName=MeasureBand13
MeterStyle=VisualizerStyle
Y=(#size#*25.9)-((5-#size#)*18)
[MeterBand14]
Meter=Bar
MeasureName=MeasureBand14
MeterStyle=VisualizerStyle
Y=(#size#*25.9)-((5-#size#)*18)
[MeterBand15]
Meter=Bar
MeasureName=MeasureBand15
MeterStyle=VisualizerStyle
Y=(#size#*25.7)-((5-#size#)*18)
[MeterBand16]
Meter=Bar
MeasureName=MeasureBand16
MeterStyle=VisualizerStyle
Y=(#size#*25.4)-((5-#size#)*18)
[MeterBand17]
Meter=Bar
MeasureName=MeasureBand17
MeterStyle=VisualizerStyle
Y=(#size#*25)-((5-#size#)*18)
[MeterBand18]
Meter=Bar
MeasureName=MeasureBand18
MeterStyle=VisualizerStyle
Y=(#size#*24.4)-((5-#size#)*18)
[MeterBand19]
Meter=Bar
MeasureName=MeasureBand19
MeterStyle=VisualizerStyle
Y=(#size#*23.6)-((5-#size#)*18)
[MeterBand20]
Meter=Bar
MeasureName=MeasureBand20
MeterStyle=VisualizerStyle
Y=(#size#*22.6)-((5-#size#)*18)
[MeterBand21]
Meter=Bar
MeasureName=MeasureBand21
MeterStyle=VisualizerStyle
Y=(#size#*21.6)-((5-#size#)*18)
[MeterBand22]
Meter=Bar
MeasureName=MeasureBand22
MeterStyle=VisualizerStyle
Y=(#size#*20.6)-((5-#size#)*18)
[MeterBand23]
Meter=Bar
MeasureName=MeasureBand23
MeterStyle=VisualizerStyle
Y=(#size#*18.8)-((5-#size#)*18)
[MeterBand24]
Meter=Bar
MeasureName=MeasureBand24
MeterStyle=VisualizerStyle
Y=(#size#*17)-((5-#size#)*18)
[MeterBand25]
Meter=Bar
MeasureName=MeasureBand25
MeterStyle=VisualizerStyle
Y=(#size#*14.8)-((5-#size#)*18)

;--------------------------------------------------------------

[Filter]
Meter=Shape
Group=Active | Info
Shape=Ellipse (#size#*18), (#size#*18), (#size#*21), (#size#*21), (#size#*3) | Fill Color 0,0,0,110 | StrokeWidth 0 | Stroke Color 115,115,115,175
X=(#size#*7)-5
Y=(#size#*5)
H=(#size#*60)
Hidden=1

[Border]
Meter=Shape
Group=Active
Shape=Ellipse (#size#*18),(#size#*18),(#size#*21.5),(#size#*21.5),(#size#*3) | Fill Color 0,0,0,0 | StrokeWidth 7 | Stroke Color 5,5,5,200
X=(#size#*6)
Y=(#size#*5)

[MeterTime]
Meter=Roundline
Group=Active | Time
MeasureName=MeasureTime
StartAngle=(Rad(90))
RotationAngle=(Rad(360))
LineLength=(#size#*21.7)
LineStart=(#size#*21.1)
X=(#size#*24)
Y=(#size#*23)
Solid=1
LineColor=#accent#
AntiAlias=1
DynamicVariables=1

[MeterTitle]
Meter=String
Group=Active | Info
MeterStyle=TextStyle
Text=#SongTitle#
FontSize=(#size#*2.9)
StringAlign=Center
X=(#size#*23.8)
Y=(#size#*15.2)
W=(#size#*38)-((5-#size#)*25)
Hidden=1

[MeterArtist]
Meter=String
Group=Active | Info
MeterStyle=TextStyle
Text=#SongArtist#
FontSize=(#size#*2.6)
StringAlign=Center
X=r
Y=(#size#*4.9)r
W=(#size#*39)
Hidden=1

[MeterAlbum]
Meter=String
Group=Active | Info
MeterStyle=TextStyle
Text=#SongAlbum#
StringStyle=Italic
FontSize=(#size#*2.3)
StringAlign=Center
X=r
Y=(#size#*4.4)r
W=(#size#*39)
Hidden=1

[MeterRepeat]
Meter=Image
Group=Active | Info
MeterStyle=Status
ImageName=#@#images\repeat.png
X=(#size#*15.8)
Y=(#size#*9)r
H=(#size#*4.8)
Hidden=1

[MeterShuffle]
Meter=Image
Group=Active | Info
MeterStyle=Status
ImageName=#@#images\shuffle.png
X=(#size#*12)r
Y=(#size#*-0.2)r
H=(#size#*5)
Hidden=1

[MeterInfo]
Meter=Image
Group=Active | Info
ImageName=#@#images\dots.png
ImageAlpha=85
PreserveAspectRatio=1
X=(#size#*14)r
Y=(#size#*22)-(#size#*2.5)
H=(#size#*5.3)
MouseOverAction=[!SetOption ImageAlpha 235][!Redraw]
MouseLeaveAction=[!SetOption ImageAlpha 85][!Redraw]
LeftMouseDownAction=[!SetOption MeterInfo ImageAlpha  245]
LeftMouseUpAction=[!SetOption MeterInfo ImageAlpha  85][!ToggleConfig "PlayMusic\Settings" "Config.ini"][!Redraw]
Hidden=1

[MeterVolume]
Meter=Roundline
MeasureName=MeasureVolume
Group=Active | Info | Volume
StartAngle=(Rad(90))
RotationAngle=(Rad(360))
LineLength=(#size#*21.7)
LineStart=(#size#*21.1)
X=(#size#*24)
Y=(#size#*23)
Solid=1
LineColor=255,255,255,200
DynamicVariables=1
AntiAlias=1
Hidden=1

[VolumeValue]
Meter=String
MeasureName=MeasureVolumeValue
Group=Active | Info | Volume
FontSize=9
StringAlign=center
FontColor=255,255,255,190
StringEffect=Shadow
FontEffectColor=190,190,190,150
X=(#size#*23.8)
Y=(#size#*39.5)
AntiAlias=1
Hidden=1

[MeterIcon]
Meter=Image
Group=Icon
ImageName=#icon#
ImageAlpha=200
ImageTint=#accent#
X=215
Y=3
H=51
PreserveAspectRatio=1
LeftMouseUpAction=[#AppPath#]
DynamicVariables=1
HIdden=1
